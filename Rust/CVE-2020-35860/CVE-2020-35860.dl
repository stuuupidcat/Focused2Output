.type Capture = ZeroCap {}
              | DerefFuncCap {FromPtrFuncCall: symbol, src: symbol}
              | FromPtrFuncCallCap {path: symbol, src: symbol, pointerName: symbol, fromPtrCall: symbol}
              | PubStructCap {src: symbol, structName: symbol, rawPointerDeclaration: symbol}
              | DerefImplCap {src: symbol, implItem: symbol, structName: symbol}
              | RawPointerFieldDeclarationCap {pointerType: symbol, src: symbol, pointerName: symbol, rawPointerDeclaration: symbol}

.type Branch = ZeroBranch {}
             | FromPtrFuncCallBr {_0: symbol}
             | PubStructBr {_0: symbol}
             | DerefImplBr {_0: symbol, _1: symbol}
             | DerefFuncBr {_0: symbol}
             | RawPointerFieldDeclarationBr {_0: symbol, _1: symbol}

.type URI = [
    lang: symbol,
    file: symbol,
    element: symbol,
    branches: Branch,
    caps: Capture
]

.decl DerefFunc(uri:URI)
.decl FromPtrFuncCall(uri:URI)
.decl DerefImpl(uri:URI)
.decl PubStruct(uri:URI)
.decl RawPointerFieldDeclaration(uri:URI)
.input DerefFunc
.input FromPtrFuncCall
.input DerefImpl
.input PubStruct
.input RawPointerFieldDeclaration

.comp Main {
    .decl PossibleNullPtrDeref(param0:URI, param1:URI)
    PossibleNullPtrDeref(struct, raw_pointer) :- PubStruct(struct), struct=[_attrStructLang,_attrStructFile,_attrStructElement,$PubStructBr(Struct_Branches0),$PubStructCap(_capStructSrc,capStructStructName,_capStructRawPointerDeclaration)], RawPointerFieldDeclaration(raw_pointer), raw_pointer=[_attrRaw_pointerLang,_attrRaw_pointerFile,attrRaw_pointerElement,_attrRaw_pointerBr,$RawPointerFieldDeclarationCap(_capRaw_pointerPointerType,_capRaw_pointerSrc,capRaw_pointerPointerName,_capRaw_pointerRawPointerDeclaration)], Struct_Branches0=attrRaw_pointerElement, DerefImpl(deref_impl), deref_impl=[_attrDeref_implLang,_attrDeref_implFile,_attrDeref_implElement,_attrDeref_implBr,$DerefImplCap(_capDeref_implSrc,_capDeref_implImplItem,capDeref_implStructName)], DerefFunc(deref_func), deref_func=[_attrDeref_funcLang,_attrDeref_funcFile,_attrDeref_funcElement,$DerefFuncBr(Deref_func_Branches0),_capderef_func], FromPtrFuncCall(from_ptr_call), from_ptr_call=[_attrFrom_ptr_callLang,_attrFrom_ptr_callFile,attrFrom_ptr_callElement,_attrFrom_ptr_callBr,$FromPtrFuncCallCap(_capFrom_ptr_callPath,_capFrom_ptr_callSrc,capFrom_ptr_callPointerName,_capFrom_ptr_callFromPtrCall)], Deref_func_Branches0=attrFrom_ptr_callElement, capStructStructName=capDeref_implStructName, capFrom_ptr_callPointerName=capRaw_pointerPointerName.
}
.init mainInstance = Main
.output mainInstance.PossibleNullPtrDeref(IO=file, rfc4180=true)

