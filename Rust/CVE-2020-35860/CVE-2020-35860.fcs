[Elements]

PubStruct:
    lang: Rust
    file: (src).rs
    element: (structName)::struct_item#struct[visibility=pub]
    branches:
        - @struct//**//(rawPointerDeclaration)::field_declaration

RawPointerFieldDeclaration:
    lang: Rust
    file: (src).rs
    element: (rawPointerDeclaration)::field_declaration#field
    branches:
        - @field/~name~/(pointerName)
        - @field/~type~/(pointerType)::pointer_type

DerefImpl:
    lang: Rust
    file: (src).rs
    element: (implItem)::impl_item#impl[trait=Deref]
    branches:
        - @impl/~target~/(structName)<str>
        - @impl//**//deref::function_item

DerefFunc:
    lang: Rust
    file: (src).rs
    element: deref::function_item#func/~return_type~/&str
    branches:
        - @func//**//(FromPtrFuncCall)::call_expression

FromPtrFuncCall:
    lang: Rust
    file: (src).rs
    element: (fromPtrCall)::call_expression#call[function=(path)from_ptr]
    branches:
        - @call//**/~arg[idx=0]~/self.(pointerName)


[Links]
    Main {
    public:
        PossibleNullPtrDeref(struct, raw_pointer):
            & PubStruct(struct)
            & RawPointerFieldDeclaration(raw_pointer)
            & match(struct.branches[0], raw_pointer.element)
            & DerefImpl(deref_impl)
            & DerefFunc(deref_func)
            & FromPtrFuncCall(from_ptr_call)
            & match(deref_func.branches[0], from_ptr_call.element)
            & match(struct[structName], deref_impl[structName])
            & match(from_ptr_call[pointerName], raw_pointer[pointerName])

    }